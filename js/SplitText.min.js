import{emojiExp as e,getText as t}from"./utils/strings.js";let _doc,_win,_coreInitted,gsap,_context,_toArray,_stripExp=/(?:\r|\n|\t\t)/g,_multipleSpacesExp=/(?:\s\s+)/g,_initCore=e=>{_doc=document,_win=window,(gsap=gsap||e||_win.gsap||console.warn("Please gsap.registerPlugin(SplitText)"))&&(_toArray=gsap.utils.toArray,_context=gsap.core.context||function(){},_coreInitted=1)},_bonusValidated=1,_getComputedStyle=e=>_win.getComputedStyle(e),_isAbsolute=e=>"absolute"===e.position||!0===e.absolute,_findSpecialChars=(e,t)=>{let i=t.length,s;for(;--i>-1;)if(s=t[i],e.substr(0,s.length)===s)return s.length},_divStart=" style='position:relative;display:inline-block;'",_cssClassFunc=(e="",t)=>{let i=~e.indexOf("++"),s=1;return i&&(e=e.split("++").join("")),()=>"<"+t+_divStart+(e?" class='"+e+(i?s++:"")+"'>":">")},_swapText=(e,t,i)=>{let s=e.nodeType;if(1===s||9===s||11===s)for(e=e.firstChild;e;e=e.nextSibling)_swapText(e,t,i);else(3===s||4===s)&&(e.nodeValue=e.nodeValue.split(t).join(i))},_pushReversed=(e,t)=>{let i=t.length;for(;--i>-1;)e.push(t[i])},_isBeforeWordDelimiter=(e,t,i)=>{let s;for(;e&&e!==t;){if(s=e._next||e.nextSibling)return s.textContent.charAt(0)===i;e=e.parentNode||e._parent}},_deWordify=e=>{let t=_toArray(e.childNodes),i=t.length,s,l;for(s=0;s<i;s++)(l=t[s])._isSplit?_deWordify(l):s&&l.previousSibling&&3===l.previousSibling.nodeType?(l.previousSibling.nodeValue+=3===l.nodeType?l.nodeValue:l.firstChild.nodeValue,e.removeChild(l)):3!==l.nodeType&&(e.insertBefore(l.firstChild,l),e.removeChild(l))},_getStyleAsNumber=(e,t)=>parseFloat(t[e])||0,_setPositionsAfterSplit=(e,t,i,s,l,n,r)=>{let o=_getComputedStyle(e),p=_getStyleAsNumber("paddingLeft",o),d=-999,a=_getStyleAsNumber("borderBottomWidth",o)+_getStyleAsNumber("borderTopWidth",o),h=_getStyleAsNumber("borderLeftWidth",o)+_getStyleAsNumber("borderRightWidth",o),g=_getStyleAsNumber("paddingTop",o)+_getStyleAsNumber("paddingBottom",o),c=_getStyleAsNumber("paddingLeft",o)+_getStyleAsNumber("paddingRight",o),x=_getStyleAsNumber("fontSize",o)*(t.lineThreshold||.2),f=o.textAlign,u=[],y=[],S=[],b=t.wordDelimiter||" ",C=t.tag?t.tag:t.span?"span":"div",m=t.type||t.split||"chars,words,lines",N=l&&~m.indexOf("lines")?[]:null,T=~m.indexOf("words"),$=~m.indexOf("chars"),v=_isAbsolute(t),_=t.linesClass,w=~(_||"").indexOf("++"),A=[],W="flex"===o.display,L=e.style.display,B,E,R,F,H,V,D,O,P,j,k,M;for(w&&(_=_.split("++").join("")),W&&(e.style.display="block"),R=(E=e.getElementsByTagName("*")).length,H=[],B=0;B<R;B++)H[B]=E[B];if(N||v)for(B=0;B<R;B++)((V=(F=H[B]).parentNode===e)||v||$&&!T)&&(M=F.offsetTop,N&&V&&Math.abs(M-d)>x&&("BR"!==F.nodeName||0===B)&&(D=[],N.push(D),d=M),v&&(F._x=F.offsetLeft,F._y=M,F._w=F.offsetWidth,F._h=F.offsetHeight),N&&((F._isSplit&&V||!$&&V||T&&V||!T&&F.parentNode.parentNode===e&&!F.parentNode._isSplit)&&(D.push(F),F._x-=p,_isBeforeWordDelimiter(F,e,b)&&(F._wordEnd=!0)),"BR"===F.nodeName&&(F.nextSibling&&"BR"===F.nextSibling.nodeName||0===B)&&N.push([])));for(B=0;B<R;B++){if(V=(F=H[B]).parentNode===e,"BR"===F.nodeName){N||v?(F.parentNode&&F.parentNode.removeChild(F),H.splice(B--,1),R--):T||e.appendChild(F);continue}if(v&&(P=F.style,T||V||(F._x+=F.parentNode._x,F._y+=F.parentNode._y),P.left=F._x+"px",P.top=F._y+"px",P.position="absolute",P.display="block",P.width=F._w+1+"px",P.height=F._h+"px"),!T&&$){if(F._isSplit)for(F._next=E=F.nextSibling,F.parentNode.appendChild(F);E&&3===E.nodeType&&" "===E.textContent;)F._next=E.nextSibling,F.parentNode.appendChild(E),E=E.nextSibling;else F.parentNode._isSplit?(F._parent=F.parentNode,!F.previousSibling&&F.firstChild&&(F.firstChild._isFirst=!0),F.nextSibling&&" "===F.nextSibling.textContent&&!F.nextSibling.nextSibling&&A.push(F.nextSibling),F._next=F.nextSibling&&F.nextSibling._isFirst?null:F.nextSibling,F.parentNode.removeChild(F),H.splice(B--,1),R--):V||(M=!F.nextSibling&&_isBeforeWordDelimiter(F.parentNode,e,b),F.parentNode._parent&&F.parentNode._parent.appendChild(F),M&&F.parentNode.appendChild(_doc.createTextNode(" ")),"span"===C&&(F.style.display="inline"),u.push(F))}else F.parentNode._isSplit&&!F._isSplit&&""!==F.innerHTML?y.push(F):$&&!F._isSplit&&("span"===C&&(F.style.display="inline"),u.push(F))}for(B=A.length;--B>-1;)A[B].parentNode.removeChild(A[B]);if(N){for(v&&(j=_doc.createElement(C),e.appendChild(j),k=j.offsetWidth+"px",M=j.offsetParent===e?0:e.offsetLeft,e.removeChild(j)),P=e.style.cssText,e.style.cssText="display:none;";e.firstChild;)e.removeChild(e.firstChild);for(B=0,O=" "===b&&(!v||!T&&!$);B<N.length;B++){for(D=N[B],(j=_doc.createElement(C)).style.cssText="display:block;text-align:"+f+";position:"+(v?"absolute;":"relative;"),_&&(j.className=_+(w?B+1:"")),S.push(j),R=D.length,E=0;E<R;E++)"BR"!==D[E].nodeName&&(F=D[E],j.appendChild(F),O&&F._wordEnd&&j.appendChild(_doc.createTextNode(" ")),v&&(0===E&&(j.style.top=F._y+"px",j.style.left=p+M+"px"),F.style.top="0px",M&&(F.style.left=F._x-M+"px")));0===R?j.innerHTML="&nbsp;":T||$||(_deWordify(j),_swapText(j,"\xa0"," ")),v&&(j.style.width=k,j.style.height=F._h+"px"),e.appendChild(j)}e.style.cssText=P}v&&(r>e.clientHeight&&(e.style.height=r-g+"px",e.clientHeight<r&&(e.style.height=r+a+"px")),n>e.clientWidth&&(e.style.width=n-c+"px",e.clientWidth<n&&(e.style.width=n+h+"px"))),W&&(L?e.style.display=L:e.style.removeProperty("display")),_pushReversed(i,u),T&&_pushReversed(s,y),_pushReversed(l,S)},_splitRawText=(i,s,l,n)=>{let r=s.tag?s.tag:s.span?"span":"div",o=~(s.type||s.split||"chars,words,lines").indexOf("chars"),p=_isAbsolute(s),d=s.wordDelimiter||" ",a=" "!==d?"":p?"&#173; ":" ",h="</"+r+">",g=1,c=s.specialChars?"function"==typeof s.specialChars?s.specialChars:_findSpecialChars:null,x,f,u,y,S,b,C,m,N=_doc.createElement("div"),T=i.parentNode;for(T.insertBefore(N,i),N.textContent=i.nodeValue,T.removeChild(i),C=-1!==(x=t(i=N)).indexOf("<"),!1!==s.reduceWhiteSpace&&(x=x.replace(_multipleSpacesExp," ").replace(_stripExp,"")),C&&(x=x.split("<").join("{{LT}}")),S=x.length,f=(" "===x.charAt(0)?a:"")+l(),u=0;u<S;u++)if(b=x.charAt(u),c&&(m=c(x.substr(u),s.specialChars)))b=x.substr(u,m||1),f+=o&&" "!==b?n()+b+"</"+r+">":b,u+=m-1;else if(b===d&&x.charAt(u-1)!==d&&u){for(f+=g?h:"",g=0;x.charAt(u+1)===d;)f+=a,u++;u===S-1?f+=a:")"!==x.charAt(u+1)&&(f+=a+l(),g=1)}else"{"===b&&"{{LT}}"===x.substr(u,6)?(f+=o?n()+"{{LT}}</"+r+">":"{{LT}}",u+=5):b.charCodeAt(0)>=55296&&56319>=b.charCodeAt(0)||x.charCodeAt(u+1)>=65024&&65039>=x.charCodeAt(u+1)?(y=((x.substr(u,12).split(e)||[])[1]||"").length||2,f+=o&&" "!==b?n()+x.substr(u,y)+"</"+r+">":x.substr(u,y),u+=y-1):f+=o&&" "!==b?n()+b+"</"+r+">":b;i.outerHTML=f+(g?h:""),C&&_swapText(T,"{{LT}}","<")},_split=(e,t,i,s)=>{let l=_toArray(e.childNodes),n=l.length,r=_isAbsolute(t),o,p;if(3!==e.nodeType||n>1){for(o=0,t.absolute=!1;o<n;o++)(p=l[o])._next=p._isFirst=p._parent=p._wordEnd=null,(3!==p.nodeType||/\S+/.test(p.nodeValue))&&(r&&3!==p.nodeType&&"inline"===_getComputedStyle(p).display&&(p.style.display="inline-block",p.style.position="relative"),p._isSplit=!0,_split(p,t,i,s));t.absolute=r,e._isSplit=!0;return}_splitRawText(e,t,i,s)};export class SplitText{constructor(e,t){_coreInitted||_initCore(),this.elements=_toArray(e),this.chars=[],this.words=[],this.lines=[],this._originals=[],this.vars=t||{},_context(this),_bonusValidated&&this.split(t)}split(e){this.isSplit&&this.revert(),this.vars=e=e||this.vars,this._originals.length=this.chars.length=this.words.length=this.lines.length=0;let t=this.elements.length,i=e.tag?e.tag:e.span?"span":"div",s=_cssClassFunc(e.wordsClass,i),l=_cssClassFunc(e.charsClass,i),n,r,o;for(;--t>-1;)o=this.elements[t],this._originals[t]=o.innerHTML,n=o.clientHeight,r=o.clientWidth,_split(o,e,s,l),_setPositionsAfterSplit(o,e,this.chars,this.words,this.lines,r,n);return this.chars.reverse(),this.words.reverse(),this.lines.reverse(),this.isSplit=!0,this}revert(){let e=this._originals;if(!e)throw"revert() call wasn't scoped properly.";return this.elements.forEach((t,i)=>t.innerHTML=e[i]),this.chars=[],this.words=[],this.lines=[],this.isSplit=!1,this}static create(e,t){return new SplitText(e,t)}}SplitText.version="3.11.5",SplitText.register=_initCore;export{SplitText as default};