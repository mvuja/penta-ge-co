let gsap,_coreInitted,_win,_doc,_docEl,_body,_root,_toArray,_clamp,ScrollTrigger,_mainInstance,_expo,_getVelocityProp,_inputObserver,_context,_onResizeDelayedCall,_windowExists=()=>"undefined"!=typeof window,_getGSAP=()=>gsap||_windowExists()&&(gsap=window.gsap)&&gsap.registerPlugin&&gsap,_bonusValidated=1,_isViewport=e=>!!~_root.indexOf(e),_getTime=Date.now,_round=e=>Math.round(1e5*e)/1e5||0,_autoDistance=(e,r)=>{let t=e.parentNode||_docEl,o=e.getBoundingClientRect(),i=t.getBoundingClientRect(),s=i.top-o.top,l=i.bottom-o.bottom,n=(Math.abs(s)>Math.abs(l)?s:l)/(1-r),a=-n*r,c,g;return n>0&&(g=.5==(c=i.height/(_win.innerHeight+i.height))?2*i.height:2*Math.min(i.height,-n*c/(2*c-1))*(r||1),a+=r?-g*r:-g/2,n+=g),{change:n,offset:a}},_wrap=e=>{let r=_doc.querySelector(".ScrollSmoother-wrapper");return r||((r=_doc.createElement("div")).classList.add("ScrollSmoother-wrapper"),e.parentNode.insertBefore(r,e),r.appendChild(e)),r};export class ScrollSmoother{constructor(e){_coreInitted||ScrollSmoother.register(gsap)||console.warn("Please gsap.registerPlugin(ScrollSmoother)"),e=this.vars=e||{},_mainInstance&&_mainInstance.kill(),_mainInstance=this,_context(this);let{smoothTouch:r,onUpdate:t,onStop:o,smooth:i,onFocusIn:s,normalizeScroll:l,wholePixels:n}=e,a,c,g,d,p,h,$,f,u,S,m,y,T,w=this,_=e.effectsPrefix||"",v=ScrollTrigger.getScrollFunc(_win),b=1===ScrollTrigger.isTouch?!0===r?.8:parseFloat(r)||0:0===i||!1===i?0:parseFloat(i)||.8,x=b&&+e.speed||1,E=0,P=0,R=1,A=_getVelocityProp(0),k=()=>A.update(-E),C={y:0},I=()=>a.style.overflow="visible",z,V=e=>{e.update();let r=e.getTween();r&&(r.pause(),r._time=r._dur,r._tTime=r._tDur),z=!1,e.animation.progress(e.progress,!0)},B=(e,r)=>{(e!==E&&!S||r)&&(n&&(e=Math.round(e)),b&&(a.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+e+", 0, 1)",a._gsap.y=e+"px"),P=e-E,E=e,ScrollTrigger.isUpdating||ScrollSmoother.isRefreshing||ScrollTrigger.update())},D=function(e){return arguments.length?(e<0&&(e=0),C.y=-e,z=!0,S?E=-e:B(-e),ScrollTrigger.isRefreshing?d.update():v(e/x),this):-E},H="undefined"!=typeof ResizeObserver&&!1!==e.autoResize&&new ResizeObserver(()=>{if(!ScrollTrigger.isRefreshing){let e=ScrollTrigger.maxScroll(c);e<-E&&D(e),_onResizeDelayedCall.restart(!0)}}),L,O=e=>{c.scrollTop=0,!(e.target.contains&&e.target.contains(c))&&(!s||!1!==s(this,e))&&(ScrollTrigger.isInViewport(e.target)||e.target===L||this.scrollTo(e.target,!1,"center center"),L=e.target)},U=(e,r)=>{let t,o,i,s;p.forEach(r=>{t=r.pins,s=r.markers,e.forEach(e=>{r.trigger&&e.trigger&&r!==e&&(e.trigger===r.trigger||e.pinnedContainer===r.trigger||r.trigger.contains(e.trigger))&&(i=((o=e.start)-r.start-r.offset)/r.ratio-(o-r.start),t.forEach(e=>i-=e.distance/r.ratio-e.distance),e.setPositions(o+i,e.end+i),e.markerStart&&s.push(gsap.quickSetter([e.markerStart,e.markerEnd],"y","px")),e.pin&&e.end>0&&(i=e.end-e.start,t.push({start:e.start,end:e.end,distance:i,trig:e}),r.setPositions(r.start,r.end+i),r.vars.onRefresh(r)))})})},G=()=>{I(),requestAnimationFrame(I),p&&(p.forEach(e=>{let r=e.start,t=e.auto?Math.min(ScrollTrigger.maxScroll(e.scroller),e.end):r+(e.end-r)/e.ratio,o=(t-e.end)/2;r-=o,t-=o,e.offset=o||1e-4,e.pins.length=0,e.setPositions(Math.min(r,t),Math.max(r,t)),e.vars.onRefresh(e)}),U(ScrollTrigger.sort())),A.reset()},N=()=>ScrollTrigger.addEventListener("refresh",G),q=()=>p&&p.forEach(e=>e.vars.onRefresh(e)),M=()=>(p&&p.forEach(e=>e.vars.onRefreshInit(e)),q),Y=(e,r,t,o)=>()=>{let i="function"==typeof r?r(t,o):r;return i||0===i||(i=o.getAttribute("data-"+_+e)||("speed"===e?1:0)),o.setAttribute("data-"+_+e,i),"auto"===i?i:parseFloat(i)},F=(e,r,t,o,i)=>{i=("function"==typeof i?i(o,e):i)||0;let s=Y("speed",r,o,e),l=Y("lag",t,o,e),n=gsap.getProperty(e,"y"),a=e._gsap,g,d,h,$,f,u,S=()=>{r=s(),t=l(),g=parseFloat(r)||1,f=(h="auto"===r)?0:.5,$&&$.kill(),$=t&&gsap.to(e,{ease:_expo,overwrite:!1,y:"+=0",duration:t}),d&&(d.ratio=g,d.autoSpeed=h)},m=()=>{a.y=n+"px",a.renderTransform(1),S()},y=[],T=[],w=0,_=r=>{if(h){m();let t=_autoDistance(e,_clamp(0,1,-r.start/(r.end-r.start)));w=t.change,u=t.offset}else w=(r.end-r.start)*(1-g),u=0;y.forEach(e=>w-=e.distance*(1-g)),r.vars.onUpdate(r),$&&$.progress(1)};return S(),(1!==g||h||$)&&(d=ScrollTrigger.create({trigger:h?e.parentNode:e,start:"top bottom+="+i,end:"bottom top-="+i,scroller:c,scrub:!0,refreshPriority:-999,onRefreshInit:m,onRefresh:_,onKill(e){let r=p.indexOf(e);r>=0&&p.splice(r,1),m()},onUpdate(e){let r=n+w*(e.progress-f),t=y.length,o=0,i,s,l;if(e.offset){if(t){for(s=-E,l=e.end;t--;){if((i=y[t]).trig.isActive||s>=i.start&&s<=i.end){$&&(i.trig.progress+=i.trig.direction<0?.001:-.001,i.trig.update(0,0,1),$.resetTo("y",parseFloat(a.y),-P,!0),R&&$.progress(1));return}s>i.end&&(o+=i.distance),l-=i.distance}r=n+o+w*((gsap.utils.clamp(e.start,e.end,s)-e.start-o)/(l-e.start)-f)}r=_round(r+u),T.length&&!h&&T.forEach(e=>e(r-o)),$?($.resetTo("y",r,-P,!0),R&&$.progress(1)):(a.y=r+"px",a.renderTransform(1))}}}),_(d),gsap.core.getCache(d.trigger).stRevert=M,d.startY=n,d.pins=y,d.markers=T,d.ratio=g,d.autoSpeed=h,e.style.willChange="transform"),d};function K(){return g=a.clientHeight,a.style.overflow="visible",_body.style.height=_win.innerHeight+(g-_win.innerHeight)/x+"px",g-_win.innerHeight}N(),ScrollTrigger.addEventListener("killAll",N),gsap.delayedCall(.5,()=>R=0),this.scrollTop=D,this.scrollTo=(e,r,t)=>{let o=gsap.utils.clamp(0,ScrollTrigger.maxScroll(_win),isNaN(e)?this.offset(e,t):+e);r?S?gsap.to(this,{duration:b,scrollTop:o,overwrite:"auto",ease:_expo}):v(o):D(o)},this.offset=(e,r)=>{let t=(e=_toArray(e)[0]).style.cssText,o=ScrollTrigger.create({trigger:e,start:r||"top top"}),i;return p&&U([o],!0),i=o.start/x,o.kill(!1),e.style.cssText=t,gsap.core.getCache(e).uncache=1,i},this.content=function(e){if(arguments.length){let r=_toArray(e||"#smooth-content")[0]||console.warn("ScrollSmoother needs a valid content element.")||_body.children[0];return r!==a&&(u=(a=r).getAttribute("style")||"",H&&H.observe(a),gsap.set(a,{overflow:"visible",width:"100%",boxSizing:"border-box",y:"+=0"}),b||gsap.set(a,{clearProps:"transform"})),this}return a},this.wrapper=function(e){return arguments.length?(f=(c=_toArray(e||"#smooth-wrapper")[0]||_wrap(a)).getAttribute("style")||"",K(),gsap.set(c,b?{overflow:"hidden",position:"fixed",height:"100%",width:"100%",top:0,left:0,right:0,bottom:0}:{overflow:"visible",position:"relative",width:"100%",height:"auto",top:"auto",bottom:"auto",left:"auto",right:"auto"}),this):c},this.effects=(e,r)=>{if(p||(p=[]),!e)return p.slice(0);(e=_toArray(e)).forEach(e=>{let r=p.length;for(;r--;)p[r].trigger===e&&p[r].kill()});let{speed:t,lag:o,effectsPadding:i}=r=r||{},s=[],l,n;for(l=0;l<e.length;l++)(n=F(e[l],t,o,l,i))&&s.push(n);return p.push(...s),s},this.sections=(e,r)=>{if(h||(h=[]),!e)return h.slice(0);let t=_toArray(e).map(e=>ScrollTrigger.create({trigger:e,start:"top 120%",end:"bottom -20%",onToggle(r){e.style.opacity=r.isActive?"1":"0",e.style.pointerEvents=r.isActive?"all":"none"}}));return r&&r.add?h.push(...t):h=t.slice(0),t},this.content(e.content),this.wrapper(e.wrapper),this.render=e=>B(e||0===e?e:E),this.getVelocity=()=>A.getVelocity(-E),ScrollTrigger.scrollerProxy(c,{scrollTop:D,scrollHeight:()=>K()&&_body.scrollHeight,fixedMarkers:!1!==e.fixedMarkers&&!!b,content:a,getBoundingClientRect:()=>({top:0,left:0,width:_win.innerWidth,height:_win.innerHeight})}),ScrollTrigger.defaults({scroller:c});let W=ScrollTrigger.getAll().filter(e=>e.scroller===_win||e.scroller===c);W.forEach(e=>e.revert(!0,!0)),d=ScrollTrigger.create({animation:gsap.fromTo(C,{y:0},{y:()=>-K(),immediateRender:!1,ease:"none",data:"ScrollSmoother",duration:100,onUpdate:function(){if(this._dur){let e=z;e&&(V(d),C.y=E),B(C.y,e),k(),t&&!S&&t(w)}}}),onRefreshInit(e){if(ScrollSmoother.isRefreshing=!0,p){let r=ScrollTrigger.getAll().filter(e=>!!e.pin);p.forEach(e=>{e.vars.pinnedContainer||r.forEach(r=>{if(r.pin.contains(e.trigger)){let t=e.vars;t.pinnedContainer=r.pin,e.vars=null,e.init(t,e.animation)}})})}let t=e.getTween();T=t&&t._end>t._dp._time,y=E,C.y=0,b&&(1===ScrollTrigger.isTouch&&(c.style.position="absolute"),c.scrollTop=0,1===ScrollTrigger.isTouch&&(c.style.position="fixed"))},onRefresh(e){e.animation.invalidate(),e.setPositions(e.start,K()/x),T||V(e),C.y=-v()*x,B(C.y),R||e.animation.progress(gsap.utils.clamp(0,1,-(y/x/e.end))),T&&(e.progress-=.001,e.update()),ScrollSmoother.isRefreshing=!1},id:"ScrollSmoother",scroller:_win,invalidateOnRefresh:!0,start:0,refreshPriority:-9999,end:()=>K()/x,onScrubComplete:()=>{A.reset(),o&&o(this)},scrub:b||!0}),this.smooth=function(r){return arguments.length&&(x=(b=r||0)&&+e.speed||1,d.scrubDuration(r)),d.getTween()?d.getTween().duration():0},d.getTween()&&(d.getTween().vars.ease=e.ease||_expo),this.scrollTrigger=d,e.effects&&this.effects(!0===e.effects?"[data-"+_+"speed], [data-"+_+"lag]":e.effects,{effectsPadding:e.effectsPadding}),e.sections&&this.sections(!0===e.sections?"[data-section]":e.sections),W.forEach(e=>{e.vars.scroller=c,e.revert(!1,!0),e.init(e.vars,e.animation)}),this.paused=function(e,r){return arguments.length?(!!S!==e&&(e?(d.getTween()&&d.getTween().pause(),v(-E/x),A.reset(),(m=ScrollTrigger.normalizeScroll())&&m.disable(),(S=ScrollTrigger.observe({preventDefault:!0,type:"wheel,touch,scroll",debounce:!1,allowClicks:!0,onChangeY:()=>D(-E)})).nested=_inputObserver(_docEl,"wheel,touch,scroll",!0,!1!==r)):(S.nested.kill(),S.kill(),S=0,m&&m.enable(),d.progress=(-E/x-d.start)/(d.end-d.start),V(d))),this):!!S},this.kill=this.revert=()=>{this.paused(!1),V(d),d.kill();let e=(p||[]).concat(h||[]),r=e.length;for(;r--;)e[r].kill();ScrollTrigger.scrollerProxy(c),ScrollTrigger.removeEventListener("killAll",N),ScrollTrigger.removeEventListener("refresh",G),c.style.cssText=f,a.style.cssText=u;let t=ScrollTrigger.defaults({});t&&t.scroller===c&&ScrollTrigger.defaults({scroller:_win}),this.normalizer&&ScrollTrigger.normalizeScroll(!1),clearInterval($),_mainInstance=null,H&&H.disconnect(),_body.style.removeProperty("height"),_win.removeEventListener("focusin",O)},this.refresh=(e,r)=>d.refresh(e,r),l&&(this.normalizer=ScrollTrigger.normalizeScroll(!0===l?{debounce:!0,content:!b&&a}:l)),ScrollTrigger.config(e),"overscrollBehavior"in _win.getComputedStyle(_body)&&gsap.set([_body,_docEl],{overscrollBehavior:"none"}),"scrollBehavior"in _win.getComputedStyle(_body)&&gsap.set([_body,_docEl],{scrollBehavior:"auto"}),_win.addEventListener("focusin",O),$=setInterval(k,250),"loading"===_doc.readyState||requestAnimationFrame(()=>ScrollTrigger.refresh())}get progress(){return this.scrollTrigger?this.scrollTrigger.animation._time/100:0}static register(e){return!_coreInitted&&(gsap=e||_getGSAP(),_windowExists()&&window.document&&(_win=window,_docEl=(_doc=document).documentElement,_body=_doc.body),gsap&&(_toArray=gsap.utils.toArray,_clamp=gsap.utils.clamp,_expo=gsap.parseEase("expo"),_context=gsap.core.context||function(){},_onResizeDelayedCall=gsap.delayedCall(.2,()=>ScrollTrigger.isRefreshing||_mainInstance&&_mainInstance.refresh()).pause(),ScrollTrigger=gsap.core.globals().ScrollTrigger,gsap.core.globals("ScrollSmoother",ScrollSmoother),_body&&ScrollTrigger&&(_root=[_win,_doc,_docEl,_body],_getVelocityProp=ScrollTrigger.core._getVelocityProp,_inputObserver=ScrollTrigger.core._inputObserver,ScrollSmoother.refresh=ScrollTrigger.refresh,_coreInitted=1))),_coreInitted}}ScrollSmoother.version="3.11.5",ScrollSmoother.create=e=>_mainInstance&&e&&_mainInstance.content()===_toArray(e.content)[0]?_mainInstance:new ScrollSmoother(e),ScrollSmoother.get=()=>_mainInstance,_getGSAP()&&gsap.registerPlugin(ScrollSmoother);export{ScrollSmoother as default};